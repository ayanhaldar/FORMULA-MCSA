(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106869,       2554]
NotebookOptionsPosition[    103623,       2442]
NotebookOutlinePosition[    104023,       2459]
CellTagsIndexPosition[    103980,       2456]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Astar0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}], "*", "k"}], 
        RowBox[{"E0", "*", "t"}]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], "*", "\[Beta]", "*", "\[Nu]", "*", "k"}], 
        RowBox[{"E0", "*", "t"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "2"}], "*", "\[Beta]", "*", "\[Nu]", "*", "k"}], 
        RowBox[{"E0", "*", "t"}]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Beta]"}], ")"}], "*", "k"}], 
        RowBox[{"E0", "*", "t"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "E0", "*", "\[Gamma]", "*", "t"}], ")"}]}]}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Bstar0", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.5", "*", "t", "*", "k", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]", "2"], "-", "1"}], ")"}]}], ",", 
        RowBox[{"t", "*", "\[Beta]", "*", "\[Nu]", "*", "k", "*", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "1"}], ")"}]}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "t"}], "*", "\[Beta]", "*", "\[Nu]", "*", "k", "*", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", "1"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"-", "0.5"}], "*", "t", "*", "k", "*", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[Beta]", "2"], "-", "1"}], ")"}]}], ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Dstar0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"E0", "*", 
            RowBox[{
             SuperscriptBox["t", "3"], "/", "12"}]}], ")"}], "*", "k", "*", 
          "\[Beta]", "*", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Beta]", "*", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], ",", 
         RowBox[{"8", "*", "E0", "*", 
          SuperscriptBox["t", "3"], "*", "k", "*", 
          SuperscriptBox["\[Beta]", "2"], "*", "\[Nu]", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Beta]", "*", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"8", "*", "E0", "*", 
          SuperscriptBox["t", "3"], "*", "k", "*", 
          SuperscriptBox["\[Beta]", "2"], "*", "\[Nu]", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Beta]", "*", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], ",", 
         RowBox[{"4", "*", "E0", "*", 
          SuperscriptBox["t", "3"], "*", "k", "*", "\[Beta]", "*", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", "1"}], ")"}], "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"\[Beta]", "*", 
             SuperscriptBox["\[Nu]", "2"]}]}], ")"}]}], ",", "0"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"2", "*", "E0", "*", 
          SuperscriptBox["t", "3"], "*", "\[Gamma]"}]}], "}"}]}], "}"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dstar0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E0", "*", 
          RowBox[{
           SuperscriptBox["t", "3"], "/", "12"}]}], ")"}], "*", "k", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"14", "*", " ", "\[Beta]"}], "+", 
          SuperscriptBox["\[Beta]", "2"], "-", 
          RowBox[{"16", "*", 
           SuperscriptBox["\[Nu]", "2"], "*", 
           SuperscriptBox["\[Beta]", "2"]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E0", "*", 
          RowBox[{
           SuperscriptBox["t", "3"], "/", "6"}]}], ")"}], "*", "k", "*", 
        "\[Beta]", "*", "\[Nu]", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"14", "*", " ", "\[Beta]"}], "+", 
          SuperscriptBox["\[Beta]", "2"], "-", 
          RowBox[{"16", "*", 
           SuperscriptBox["\[Nu]", "2"], "*", 
           SuperscriptBox["\[Beta]", "2"]}]}], ")"}]}], ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E0", "*", 
          RowBox[{
           SuperscriptBox["t", "3"], "/", "6"}]}], ")"}], "*", "k", "*", 
        "\[Beta]", "*", "\[Nu]", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"14", "*", " ", "\[Beta]"}], "+", 
          SuperscriptBox["\[Beta]", "2"], "-", 
          RowBox[{"16", "*", 
           SuperscriptBox["\[Nu]", "2"], "*", 
           SuperscriptBox["\[Beta]", "2"]}]}], ")"}]}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"E0", "*", 
          RowBox[{
           SuperscriptBox["t", "3"], "/", "12"}]}], ")"}], "*", "k", "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Beta]"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"14", "*", " ", "\[Beta]"}], "+", 
          SuperscriptBox["\[Beta]", "2"], "-", 
          RowBox[{"16", "*", 
           SuperscriptBox["\[Nu]", "2"], "*", 
           SuperscriptBox["\[Beta]", "2"]}]}], ")"}]}], ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "/", "3"}], ")"}], "*", "E0", "*", 
        SuperscriptBox["t", "3"], "*", "\[Gamma]"}]}], "}"}]}], "}"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MemEnSc", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], "*", "\[Phi]t", "*", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["kxy0", "2"], "-", 
       RowBox[{"kxx0", "*", "kyy0"}]}], ")"}], "2"]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BendEnSc", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], "*", 
    RowBox[{
     RowBox[{"Transpose", "[", "kvec0", "]"}], ".", "Dst", ".", "kvec0"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ThermalEnSc", " ", "=", " ", 
   RowBox[{"t", "*", "\[CapitalDelta]T", "*", " ", 
    RowBox[{"(", 
     RowBox[{"T1", " ", "+", " ", 
      RowBox[{"kyy0", "*", "t", "*", 
       RowBox[{"(", 
        RowBox[{"-", "T2"}], ")"}]}], " ", "+", " ", 
      RowBox[{"kxx0", "*", "t", "*", "T2"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7900817045592194`*^9, 3.790081766721489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Bonding", " ", "Phase"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.790081820491685*^9, 3.7900818586171227`*^9}, 
   3.7900836098099546`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q0", " ", "=", 
   RowBox[{"E0", "*", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "\[Beta]", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Gamma]"}], "}"}]}], "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Q90", " ", "=", 
   RowBox[{"E0", "*", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", " ", 
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Gamma]"}], "}"}]}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.790088741901271*^9, 3.790088742532774*^9}, {
   3.7900893566359253`*^9, 3.7900894220464697`*^9}, {3.7900894657391043`*^9, 
   3.790089485078923*^9}, {3.7900913520348682`*^9, 3.7900914058171673`*^9}, 
   3.7900914398997564`*^9, 3.79009159417661*^9, {3.7921375981662006`*^9, 
   3.7921376144808683`*^9}, 3.7921376447105045`*^9, {3.7921384340731945`*^9, 
   3.7921384364088545`*^9}, {3.800568697461855*^9, 3.800568698598085*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q0", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.79215458994267*^9, 3.792154595380553*^9}, 
   3.800608691582942*^9, 3.800609460503606*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"E0", 
      RowBox[{"E0", " ", "\[Beta]", " ", "\[Nu]"}], "0"},
     {
      RowBox[{"E0", " ", "\[Beta]", " ", "\[Nu]"}], 
      RowBox[{"E0", " ", "\[Beta]"}], "0"},
     {"0", "0", 
      RowBox[{"E0", " ", "\[Gamma]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.792154595826296*^9, 3.800568822104006*^9, {3.8006086880149755`*^9, 
   3.800608692192591*^9}, 3.8006094613591137`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Amatd", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Qm0", " ", "*", "t"}], "+", " ", 
       RowBox[{"Qm90", "*", 
        RowBox[{"-", "t"}]}]}], ")"}], " ", "//", "Expand"}], " ", "//", 
    "Simplify"}], " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.7900895518998985`*^9, 3.790089589287301*^9}, {
  3.7900914453596478`*^9, 3.790091451288253*^9}, {3.7921374510319424`*^9, 
  3.792137454043217*^9}, {3.7921377837001305`*^9, 3.7921377864095745`*^9}, {
  3.792137896753289*^9, 3.7921379036563363`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"Qm0", "-", "Qm90"}], ")"}], " ", "t"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7921379054003377`*^9, 3.8005688268084865`*^9}]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"E0", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]"}], ")"}]}], 
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Beta]", " ", "\[Nu]"}], "0"},
     {
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Beta]", " ", "\[Nu]"}], 
      RowBox[{"E0", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]"}], ")"}]}], "0"},
     {"0", "0", 
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Gamma]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Input",
 CellChangeTimes->{{3.7921377149186215`*^9, 3.7921377174101963`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Bmatd", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Qm0", " ", "*", 
         RowBox[{
          SuperscriptBox["t", "2"], "/", "2"}]}], "+", " ", "Qm90"}], ")"}], 
      "*", 
      SuperscriptBox["t", "1"]}], " ", "//", "Expand"}], " ", "//", 
    "Simplify"}], " ", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.79213778912202*^9, 3.7921378065440474`*^9}, {
  3.79213785431518*^9, 3.79213785536258*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"Qm90", " ", "t"}], "+", 
   FractionBox[
    RowBox[{"Qm0", " ", 
     SuperscriptBox["t", "3"]}], "2"]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.800568830875082*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"kxx", ",", "kyy", ",", 
      RowBox[{"2", "*", "kxy0"}]}], "}"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Epsilon]", " ", "=", " ", 
  RowBox[{"z", "*", "kvec"}]}]}], "Input",
 CellChangeTimes->{{3.7900916435824895`*^9, 3.7900917267220225`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"kxx", " ", "z"}], ",", 
    RowBox[{"kyy", " ", "z"}], ",", 
    RowBox[{"2", " ", "kxy0", " ", "z"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.7900917286839027`*^9, 3.7901850045168715`*^9, 
  3.8005687048699193`*^9, 3.800568772647972*^9, 3.800568912149679*^9, 
  3.8006064333232245`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Epsilon]", "//", "Dimensions"}]], "Input",
 CellChangeTimes->{{3.7900917717794294`*^9, 3.790091781406931*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.790091783430775*^9, 3.8005687864929714`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\[Sigma]m0", "=", " ", 
  RowBox[{"Qm0", ".", 
   RowBox[{"Transpose", "[", "kvec", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Sigma]m90", " ", "=", " ", 
  RowBox[{"Qm90", ".", 
   RowBox[{"Transpose", "[", "kvec", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.790091543562093*^9, 3.790091580868207*^9}, {
  3.790091625764475*^9, 3.7900916321140366`*^9}, {3.7900917369311924`*^9, 
  3.7900917503175516`*^9}, {3.7900917906096783`*^9, 3.790091846060112*^9}, {
  3.7901850151038847`*^9, 3.790185015868846*^9}}],

Cell[BoxData[
 RowBox[{"Qm0", ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "kxx", "}"}], ",", 
    RowBox[{"{", "kyy", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", " ", "kxy0"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.79018501679727*^9, 3.800568707296175*^9, 
  3.8005687887119803`*^9, 3.8005689094057407`*^9}],

Cell[BoxData[
 RowBox[{"Qm90", ".", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "kxx", "}"}], ",", 
    RowBox[{"{", "kyy", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", " ", "kxy0"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.79018501679727*^9, 3.800568707296175*^9, 
  3.8005687887119803`*^9, 3.8005689094137363`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"E0", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]m"}], ")"}]}], ",", 
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Nu]m"}], ",", "0"}], "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Nu]m"}], ",", 
      RowBox[{"E0", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]m"}], ")"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Gamma]"}]}], "}"}]}], "}"}], 
  "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"E0", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]m"}], ")"}]}], 
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Nu]m"}], "0"},
     {
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Nu]m"}], 
      RowBox[{"E0", " ", "t", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]m"}], ")"}]}], "0"},
     {"0", "0", 
      RowBox[{"2", " ", "E0", " ", "t", " ", "\[Gamma]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7900895993120193`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleLam", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "90"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"h", ",", "0", ",", 
     RowBox[{"-", "h"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7921382300444627`*^9, 3.7921382413270025`*^9}, {
  3.7921383558838987`*^9, 3.7921383694071503`*^9}, {3.800570640874222*^9, 
  3.800570660680381*^9}, {3.8006063854665365`*^9, 3.80060638705663*^9}, {
  3.800606679788083*^9, 3.800606698283527*^9}, {3.8006112069299264`*^9, 
  3.800611209181642*^9}, {3.8006140089739084`*^9, 3.8006140145936985`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"2", "*", "t0"}], "+", "tm"}], "2"]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", "t0"}], "+", "tm"}], ")"}]}]], "Output",
 CellChangeTimes->{3.8006127734644938`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angleLam", "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.792138264090342*^9, 3.792138266989683*^9}}],

Cell[BoxData["90"], "Output",
 CellChangeTimes->{{3.792138264800935*^9, 3.7921382676692896`*^9}, 
   3.8005687943946767`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Qbarmatrix", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", " ", 
     RowBox[{"{", "3", "}"}], ",", " ", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.5728532938916016`*^9, 3.5728532998515625`*^9}, {
   3.5728533761679688`*^9, 3.572853425008789*^9}, {3.5728534668554688`*^9, 
   3.5728535771953125`*^9}, {3.572853637208008*^9, 3.572853641682617*^9}, {
   3.572853869466797*^9, 3.5728538713583984`*^9}, {3.572854015955078*^9, 
   3.572854020892578*^9}, {3.572945591048828*^9, 3.5729455975966797`*^9}, {
   3.5729456636757812`*^9, 3.5729456693632812`*^9}, {3.5746698575039062`*^9, 
   3.574669876098633*^9}, 3.5746700220751953`*^9, {3.5746702991845703`*^9, 
   3.5746703025595703`*^9}, {3.5746705389472656`*^9, 
   3.5746705402626953`*^9}, {3.634036704603436*^9, 3.634036710818447*^9}, {
   3.634037163829729*^9, 3.6340373030137544`*^9}, {3.6340375427322083`*^9, 
   3.634037564243743*^9}, {3.634037644504654*^9, 3.6340377401565127`*^9}, {
   3.6340378887515583`*^9, 3.6340378987934775`*^9}, {3.6340380721321945`*^9, 
   3.634038134975618*^9}, {3.634038272312996*^9, 3.634038305571559*^9}, {
   3.634038429692766*^9, 3.6340384542288895`*^9}, {3.6340384983954563`*^9, 
   3.6340385064923134`*^9}, {3.634038892166791*^9, 3.634038924385851*^9}, 
   3.6340389691809506`*^9, 3.634039025634086*^9, {3.6340400507632165`*^9, 
   3.6340400516282187`*^9}, 3.6340402780794725`*^9, {3.6340403088335047`*^9, 
   3.6340403089305096`*^9}, {3.634040591333089*^9, 3.634040605808111*^9}, {
   3.634040739457316*^9, 3.6340407987504063`*^9}, {3.6340410644988413`*^9, 
   3.6340410665908456`*^9}, {3.634041101583902*^9, 3.6340411031939044`*^9}, {
   3.634041490703528*^9, 3.634041492806532*^9}, {3.6340416786641364`*^9, 
   3.6340416812861404`*^9}, {3.6340417201562014`*^9, 3.634041748995245*^9}, {
   3.6340424804687233`*^9, 3.6340424869637337`*^9}, {3.634042678493037*^9, 
   3.634042686904052*^9}, {3.634042829709272*^9, 3.634042875080358*^9}, {
   3.6340429591914854`*^9, 3.6340430393046193`*^9}, {3.6342993100947437`*^9, 
   3.6342993113347454`*^9}, 3.6342999015998864`*^9, 3.634300023906088*^9, {
   3.634300091829245*^9, 3.6343001315793395`*^9}, {3.6343001859674687`*^9, 
   3.6343002460736146`*^9}, 3.6343012695307436`*^9, {3.6343012998288136`*^9, 
   3.634301300122814*^9}, {3.6343017328833303`*^9, 3.634301735301445*^9}, {
   3.63430195189984*^9, 3.6343019552388487`*^9}, 3.634302055559372*^9, 
   3.6343021222080936`*^9, {3.6343030824527297`*^9, 3.6343030949689894`*^9}, {
   3.634303800034294*^9, 3.6343038060343103`*^9}, 3.634304033004777*^9, {
   3.6343067362375402`*^9, 3.634306742979557*^9}, {3.6343070273368835`*^9, 
   3.63430703641391*^9}, {3.6343071980482597`*^9, 3.634307233160331*^9}, 
   3.6343074959820695`*^9, {3.6343075626396227`*^9, 3.634307576310732*^9}, {
   3.6343078124406595`*^9, 3.634307820280795*^9}, {3.634308105317828*^9, 
   3.634308108620885*^9}, {3.6343232463278627`*^9, 3.634323246547863*^9}, {
   3.6343234260182467`*^9, 3.634323430258253*^9}, {3.634329468145095*^9, 
   3.634329474005103*^9}, {3.6343297967814093`*^9, 3.634329801701416*^9}, {
   3.6343758393864503`*^9, 3.6343758596238832`*^9}, {3.6343761136003995`*^9, 
   3.6343761147904267`*^9}, {3.6343762276307626`*^9, 3.634376233115875*^9}, {
   3.6343763701062174`*^9, 3.6343763713982763`*^9}, {3.6343766451139383`*^9, 
   3.634376645935976*^9}, {3.6343767800008326`*^9, 3.6343767896973085`*^9}, {
   3.6370569622356625`*^9, 3.6370569677956705`*^9}, 3.637071990413788*^9, {
   3.637072024603836*^9, 3.6370720334538484`*^9}, 3.637072237414134*^9, 
   3.637072303324226*^9, {3.6370728044849277`*^9, 3.637072807354932*^9}, {
   3.6370729608371544`*^9, 3.637073011047225*^9}, {3.6372414491004477`*^9, 
   3.637241450990451*^9}, {3.637241567680627*^9, 3.637241574693149*^9}, {
   3.6372635621523304`*^9, 3.63726358148536*^9}, {3.637263621437416*^9, 
   3.6372637054075356`*^9}, {3.6372637586026106`*^9, 
   3.6372637693846254`*^9}, {3.6372646024325137`*^9, 
   3.6372646045325165`*^9}, {3.6372649246359067`*^9, 3.6372649435289392`*^9}, 
   3.6372651605783095`*^9, {3.6372656730822625`*^9, 3.63726570677919*^9}, {
   3.6372671072282906`*^9, 3.637267112355584*^9}, {3.6372671452714667`*^9, 
   3.637267150700777*^9}, {3.637267190193036*^9, 3.637267211532257*^9}, {
   3.6372672609660845`*^9, 3.6372672759009385`*^9}, {3.63726737121739*^9, 
   3.637267455642219*^9}, {3.6372674994147224`*^9, 3.637267502706911*^9}, {
   3.6372676355795107`*^9, 3.637267642077883*^9}, {3.6372676967870116`*^9, 
   3.6372677287588406`*^9}, {3.63726802597084*^9, 3.6372681066094522`*^9}, {
   3.6372684656889906`*^9, 3.6372684661830187`*^9}, {3.6372685401502495`*^9, 
   3.6372685410543013`*^9}, {3.63726915523143*^9, 3.6372691818799543`*^9}, {
   3.6373205303025727`*^9, 3.637320561287624*^9}, {3.6373219252218313`*^9, 
   3.6373219509438734`*^9}, {3.637352113598833*^9, 3.637352114258834*^9}, {
   3.6742875521396894`*^9, 3.6742876736586895`*^9}, {3.674287718110689*^9, 
   3.6742877858986893`*^9}, {3.6742878601726894`*^9, 
   3.6742878650546894`*^9}, {3.6742879294016895`*^9, 3.674287930892689*^9}, {
   3.674287983664689*^9, 3.6742880286986895`*^9}, {3.674288073471689*^9, 
   3.6742882683396893`*^9}, {3.674288311847689*^9, 3.674288361471689*^9}, {
   3.674288410215689*^9, 3.674288461723689*^9}, {3.674289167637689*^9, 
   3.6742892066206894`*^9}, {3.6742899115696893`*^9, 3.674289918258689*^9}, {
   3.6742900944156895`*^9, 3.674290109446689*^9}, {3.6742901797146893`*^9, 
   3.674290180692689*^9}, {3.674290265428689*^9, 3.6742902906546893`*^9}, {
   3.674290360317689*^9, 3.674290370215689*^9}, {3.6749939306800504`*^9, 
   3.6749939319170604`*^9}, {3.6749940811004744`*^9, 3.674994092986932*^9}, {
   3.674994138118081*^9, 3.674994146085888*^9}, {3.6749955345864506`*^9, 
   3.674995555999687*^9}, {3.6750704083481503`*^9, 3.675070423577298*^9}, 
   3.675070473571554*^9, {3.675072520605866*^9, 3.675072536086192*^9}, 
   3.6750794747241764`*^9, 3.675079541045251*^9, {3.6750796000887165`*^9, 
   3.6750796021333427`*^9}, {3.6750796796045294`*^9, 
   3.6750796931358347`*^9}, {3.675079729274564*^9, 3.675079729483761*^9}, {
   3.6750798178807573`*^9, 3.675079819103448*^9}, {3.6750799072193613`*^9, 
   3.6750799086266003`*^9}, {3.675079944946862*^9, 3.6750799511471024`*^9}, {
   3.6750800392316637`*^9, 3.675080102155428*^9}, {3.6751418510627832`*^9, 
   3.67514187068829*^9}, {3.6751437157493153`*^9, 3.6751437354734373`*^9}, {
   3.6760257212491884`*^9, 3.676025743025861*^9}, {3.677843597458217*^9, 
   3.6778436634868193`*^9}, {3.677844976293087*^9, 3.677845001348592*^9}, {
   3.677845959711419*^9, 3.6778460108045273`*^9}, {3.677923966426543*^9, 
   3.6779239882595434`*^9}, {3.677927591894543*^9, 3.677927770986543*^9}, {
   3.677928231007543*^9, 3.6779282310405436`*^9}, {3.6779296467645435`*^9, 
   3.6779296470145435`*^9}, {3.677931253479543*^9, 3.6779312535305433`*^9}, {
   3.677932887401543*^9, 3.677932916494543*^9}, 3.677932950015543*^9, {
   3.6779337650165434`*^9, 3.6779337998305435`*^9}, {3.678018009255468*^9, 
   3.678018033856826*^9}, {3.678018535298154*^9, 3.678018574909115*^9}, {
   3.678018697954418*^9, 3.6780187243430567`*^9}, {3.6780190230519247`*^9, 
   3.678019025267146*^9}, 3.6780190738620048`*^9, {3.711712880915103*^9, 
   3.711712925322191*^9}, 3.71171300153358*^9, {3.7889942773714275`*^9, 
   3.7889944003001995`*^9}, {3.7889946199384155`*^9, 3.7889946230559654`*^9}, 
   3.7889950903701396`*^9, {3.7920125338329782`*^9, 3.7920125428078327`*^9}, {
   3.792012726299651*^9, 3.7920127344110036`*^9}, 3.792138514096207*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Qbarmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All"}], "]"}], "]"}], " ", "=", " ", "Q0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Qbarmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "All"}], "]"}], "]"}], " ", "=", " ", "Q90"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7921384229015937`*^9, 3.7921384527824774`*^9}, {
  3.7921388936828585`*^9, 3.7921388971338778`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"alphabarmatrix", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", "2", "}"}], ",", " ", 
      RowBox[{"{", "3", "}"}], ",", " ", 
      RowBox[{"{", "1", "}"}]}], "]"}]}], " ", ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "initialization", " ", "of", " ", "alpha", " ", "in", " ", "global", " ", 
    "for", " ", "each", " ", "lamina"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.5728532938916016`*^9, 3.5728532998515625`*^9}, {
   3.5728533761679688`*^9, 3.572853425008789*^9}, {3.5728534668554688`*^9, 
   3.5728535771953125`*^9}, {3.572853637208008*^9, 3.572853641682617*^9}, {
   3.572853869466797*^9, 3.5728538713583984`*^9}, {3.572854015955078*^9, 
   3.572854020892578*^9}, {3.572945591048828*^9, 3.5729455975966797`*^9}, {
   3.5729456636757812`*^9, 3.5729456693632812`*^9}, {3.5746698575039062`*^9, 
   3.574669876098633*^9}, 3.5746700220751953`*^9, {3.5746702991845703`*^9, 
   3.5746703025595703`*^9}, {3.5746705389472656`*^9, 
   3.5746705402626953`*^9}, {3.634036704603436*^9, 3.634036710818447*^9}, {
   3.634037163829729*^9, 3.6340373030137544`*^9}, {3.6340375427322083`*^9, 
   3.634037564243743*^9}, {3.634037644504654*^9, 3.6340377401565127`*^9}, {
   3.6340378887515583`*^9, 3.6340378987934775`*^9}, {3.6340380721321945`*^9, 
   3.634038134975618*^9}, {3.634038272312996*^9, 3.634038305571559*^9}, {
   3.634038429692766*^9, 3.6340384542288895`*^9}, {3.6340384983954563`*^9, 
   3.6340385064923134`*^9}, {3.634038892166791*^9, 3.634038924385851*^9}, 
   3.6340389691809506`*^9, 3.634039025634086*^9, {3.6340400507632165`*^9, 
   3.6340400516282187`*^9}, 3.6340402780794725`*^9, {3.6340403088335047`*^9, 
   3.6340403089305096`*^9}, {3.634040591333089*^9, 3.634040605808111*^9}, {
   3.634040739457316*^9, 3.6340407987504063`*^9}, {3.6340410644988413`*^9, 
   3.6340410665908456`*^9}, {3.634041101583902*^9, 3.6340411031939044`*^9}, {
   3.634041490703528*^9, 3.634041492806532*^9}, {3.6340416786641364`*^9, 
   3.6340416812861404`*^9}, {3.6340417201562014`*^9, 3.634041748995245*^9}, {
   3.6340424804687233`*^9, 3.6340424869637337`*^9}, {3.634042678493037*^9, 
   3.634042686904052*^9}, {3.634042829709272*^9, 3.634042875080358*^9}, {
   3.6340429591914854`*^9, 3.6340430393046193`*^9}, {3.6342993100947437`*^9, 
   3.6342993113347454`*^9}, 3.6342999015998864`*^9, 3.634300023906088*^9, {
   3.634300091829245*^9, 3.6343001315793395`*^9}, {3.6343001859674687`*^9, 
   3.6343002460736146`*^9}, 3.6343012695307436`*^9, {3.6343012998288136`*^9, 
   3.634301300122814*^9}, {3.6343017328833303`*^9, 3.634301735301445*^9}, {
   3.63430195189984*^9, 3.6343019552388487`*^9}, 3.634302055559372*^9, 
   3.6343021222080936`*^9, {3.6343030824527297`*^9, 3.6343030949689894`*^9}, {
   3.634303800034294*^9, 3.6343038060343103`*^9}, 3.634304033004777*^9, {
   3.6343067362375402`*^9, 3.634306742979557*^9}, {3.6343070273368835`*^9, 
   3.63430703641391*^9}, {3.6343071980482597`*^9, 3.634307233160331*^9}, 
   3.6343074959820695`*^9, {3.6343075626396227`*^9, 3.634307576310732*^9}, {
   3.6343078124406595`*^9, 3.634307820280795*^9}, {3.634308105317828*^9, 
   3.634308108620885*^9}, {3.6343232463278627`*^9, 3.634323246547863*^9}, {
   3.6343234260182467`*^9, 3.634323430258253*^9}, {3.634329468145095*^9, 
   3.634329474005103*^9}, {3.6343297967814093`*^9, 3.634329801701416*^9}, {
   3.6343758393864503`*^9, 3.6343758596238832`*^9}, {3.6343761136003995`*^9, 
   3.6343761147904267`*^9}, {3.6343762276307626`*^9, 3.634376233115875*^9}, {
   3.6343763701062174`*^9, 3.6343763713982763`*^9}, {3.6343766451139383`*^9, 
   3.634376645935976*^9}, {3.6343767800008326`*^9, 3.6343767896973085`*^9}, {
   3.6370569622356625`*^9, 3.6370569677956705`*^9}, 3.637071990413788*^9, {
   3.637072024603836*^9, 3.6370720334538484`*^9}, 3.637072237414134*^9, 
   3.637072303324226*^9, {3.6370728044849277`*^9, 3.637072807354932*^9}, {
   3.6370729608371544`*^9, 3.637073011047225*^9}, {3.6372414491004477`*^9, 
   3.637241450990451*^9}, {3.637241567680627*^9, 3.637241574693149*^9}, {
   3.6372635621523304`*^9, 3.63726358148536*^9}, {3.637263621437416*^9, 
   3.6372637054075356`*^9}, {3.6372637586026106`*^9, 
   3.6372637693846254`*^9}, {3.6372646024325137`*^9, 
   3.6372646045325165`*^9}, {3.6372649246359067`*^9, 3.6372649435289392`*^9}, 
   3.6372651605783095`*^9, {3.6372656730822625`*^9, 3.63726570677919*^9}, {
   3.6372671072282906`*^9, 3.637267112355584*^9}, {3.6372671452714667`*^9, 
   3.637267150700777*^9}, {3.637267190193036*^9, 3.637267211532257*^9}, {
   3.6372672609660845`*^9, 3.6372672759009385`*^9}, {3.63726737121739*^9, 
   3.637267455642219*^9}, {3.6372674994147224`*^9, 3.637267502706911*^9}, {
   3.6372676355795107`*^9, 3.637267642077883*^9}, {3.6372676967870116`*^9, 
   3.6372677287588406`*^9}, {3.63726802597084*^9, 3.6372681066094522`*^9}, {
   3.6372684656889906`*^9, 3.6372684661830187`*^9}, {3.6372685401502495`*^9, 
   3.6372685410543013`*^9}, {3.63726915523143*^9, 3.6372691818799543`*^9}, {
   3.6373205303025727`*^9, 3.637320561287624*^9}, {3.6373219252218313`*^9, 
   3.6373219509438734`*^9}, {3.637352113598833*^9, 3.637352114258834*^9}, {
   3.6742875521396894`*^9, 3.6742876736586895`*^9}, {3.674287718110689*^9, 
   3.6742877858986893`*^9}, {3.6742878601726894`*^9, 
   3.6742878650546894`*^9}, {3.6742879294016895`*^9, 3.674287930892689*^9}, {
   3.674287983664689*^9, 3.6742880286986895`*^9}, {3.674288073471689*^9, 
   3.6742882683396893`*^9}, {3.674288311847689*^9, 3.674288361471689*^9}, {
   3.674288410215689*^9, 3.674288461723689*^9}, {3.674289167637689*^9, 
   3.6742892066206894`*^9}, {3.6742899115696893`*^9, 3.674289918258689*^9}, {
   3.6742900944156895`*^9, 3.674290109446689*^9}, {3.6742901797146893`*^9, 
   3.674290180692689*^9}, {3.674290265428689*^9, 3.6742902906546893`*^9}, {
   3.674290360317689*^9, 3.674290370215689*^9}, {3.6749939306800504`*^9, 
   3.6749939319170604`*^9}, {3.6749940811004744`*^9, 3.674994092986932*^9}, {
   3.674994138118081*^9, 3.674994146085888*^9}, {3.6749955345864506`*^9, 
   3.674995555999687*^9}, {3.6750704083481503`*^9, 3.675070423577298*^9}, 
   3.675070473571554*^9, {3.675072520605866*^9, 3.675072536086192*^9}, 
   3.6750794747241764`*^9, 3.675079541045251*^9, {3.6750796000887165`*^9, 
   3.6750796021333427`*^9}, {3.6750796796045294`*^9, 
   3.6750796931358347`*^9}, {3.675079729274564*^9, 3.675079729483761*^9}, {
   3.6750798178807573`*^9, 3.675079819103448*^9}, {3.6750799072193613`*^9, 
   3.6750799086266003`*^9}, {3.675079944946862*^9, 3.6750799511471024`*^9}, {
   3.6750800392316637`*^9, 3.675080102155428*^9}, {3.6751418510627832`*^9, 
   3.67514187068829*^9}, {3.6751437157493153`*^9, 3.6751437354734373`*^9}, {
   3.6760257212491884`*^9, 3.676025743025861*^9}, {3.677843597458217*^9, 
   3.6778436634868193`*^9}, {3.677844976293087*^9, 3.677845001348592*^9}, {
   3.677845959711419*^9, 3.6778460108045273`*^9}, {3.677923966426543*^9, 
   3.6779239882595434`*^9}, {3.677927591894543*^9, 3.677927770986543*^9}, {
   3.677928231007543*^9, 3.6779282310405436`*^9}, {3.6779296467645435`*^9, 
   3.6779296470145435`*^9}, {3.677931253479543*^9, 3.6779312535305433`*^9}, {
   3.677932887401543*^9, 3.677932916494543*^9}, 3.677932950015543*^9, {
   3.6779337650165434`*^9, 3.6779337998305435`*^9}, {3.678018009255468*^9, 
   3.678018033856826*^9}, {3.678018535298154*^9, 3.678018574909115*^9}, {
   3.678018697954418*^9, 3.6780187243430567`*^9}, {3.6780190230519247`*^9, 
   3.678019025267146*^9}, 3.6780190738620048`*^9, {3.711712880915103*^9, 
   3.711712925322191*^9}, 3.71171300153358*^9, {3.7889942773714275`*^9, 
   3.7889944003001995`*^9}, {3.7889946199384155`*^9, 3.7889946230559654`*^9}, 
   3.7889950903701396`*^9, {3.7920125338329782`*^9, 3.7920125428078327`*^9}, {
   3.792012726299651*^9, 3.7920127344110036`*^9}, 3.7921387649872313`*^9, {
   3.7921389024648223`*^9, 3.7921389066804156`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ThermalFM", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5728532938916016`*^9, 3.5728532998515625`*^9}, {
   3.5728533761679688`*^9, 3.572853425008789*^9}, {3.5728534668554688`*^9, 
   3.5728535771953125`*^9}, {3.572853637208008*^9, 3.572853641682617*^9}, {
   3.572853869466797*^9, 3.5728538713583984`*^9}, {3.572854015955078*^9, 
   3.572854020892578*^9}, {3.572945591048828*^9, 3.5729455975966797`*^9}, {
   3.5729456636757812`*^9, 3.5729456693632812`*^9}, {3.5746698575039062`*^9, 
   3.574669876098633*^9}, 3.5746700220751953`*^9, {3.5746702991845703`*^9, 
   3.5746703025595703`*^9}, {3.5746705389472656`*^9, 
   3.5746705402626953`*^9}, {3.634036704603436*^9, 3.634036710818447*^9}, {
   3.634037163829729*^9, 3.6340373030137544`*^9}, {3.6340375427322083`*^9, 
   3.634037564243743*^9}, {3.634037644504654*^9, 3.6340377401565127`*^9}, {
   3.6340378887515583`*^9, 3.6340378987934775`*^9}, {3.6340380721321945`*^9, 
   3.634038134975618*^9}, {3.634038272312996*^9, 3.634038305571559*^9}, {
   3.634038429692766*^9, 3.6340384542288895`*^9}, {3.6340384983954563`*^9, 
   3.6340385064923134`*^9}, {3.634038892166791*^9, 3.634038924385851*^9}, 
   3.6340389691809506`*^9, 3.634039025634086*^9, {3.6340400507632165`*^9, 
   3.6340400516282187`*^9}, 3.6340402780794725`*^9, {3.6340403088335047`*^9, 
   3.6340403089305096`*^9}, {3.634040591333089*^9, 3.634040605808111*^9}, {
   3.634040739457316*^9, 3.6340407987504063`*^9}, {3.6340410644988413`*^9, 
   3.6340410665908456`*^9}, {3.634041101583902*^9, 3.6340411031939044`*^9}, {
   3.634041490703528*^9, 3.634041492806532*^9}, {3.6340416786641364`*^9, 
   3.6340416812861404`*^9}, {3.6340417201562014`*^9, 3.634041748995245*^9}, {
   3.6340424804687233`*^9, 3.6340424869637337`*^9}, {3.634042678493037*^9, 
   3.634042686904052*^9}, {3.634042829709272*^9, 3.634042875080358*^9}, {
   3.6340429591914854`*^9, 3.6340430393046193`*^9}, {3.6342993100947437`*^9, 
   3.6342993113347454`*^9}, 3.6342999015998864`*^9, 3.634300023906088*^9, {
   3.634300091829245*^9, 3.6343001315793395`*^9}, {3.6343001859674687`*^9, 
   3.6343002460736146`*^9}, 3.6343012695307436`*^9, {3.6343012998288136`*^9, 
   3.634301300122814*^9}, {3.6343017328833303`*^9, 3.634301735301445*^9}, {
   3.63430195189984*^9, 3.6343019552388487`*^9}, 3.634302055559372*^9, 
   3.6343021222080936`*^9, {3.6343030824527297`*^9, 3.6343030949689894`*^9}, {
   3.634303800034294*^9, 3.6343038060343103`*^9}, 3.634304033004777*^9, {
   3.6343067362375402`*^9, 3.634306742979557*^9}, {3.6343070273368835`*^9, 
   3.63430703641391*^9}, {3.6343071980482597`*^9, 3.634307233160331*^9}, 
   3.6343074959820695`*^9, {3.6343075626396227`*^9, 3.634307576310732*^9}, {
   3.6343078124406595`*^9, 3.634307820280795*^9}, {3.634308105317828*^9, 
   3.634308108620885*^9}, {3.6343232463278627`*^9, 3.634323246547863*^9}, {
   3.6343234260182467`*^9, 3.634323430258253*^9}, {3.634329468145095*^9, 
   3.634329474005103*^9}, {3.6343297967814093`*^9, 3.634329801701416*^9}, {
   3.6343758393864503`*^9, 3.6343758596238832`*^9}, {3.6343761136003995`*^9, 
   3.6343761147904267`*^9}, {3.6343762276307626`*^9, 3.634376233115875*^9}, {
   3.6343763701062174`*^9, 3.6343763713982763`*^9}, {3.6343766451139383`*^9, 
   3.634376645935976*^9}, {3.6343767800008326`*^9, 3.6343767896973085`*^9}, {
   3.6370569622356625`*^9, 3.6370569677956705`*^9}, 3.637071990413788*^9, {
   3.637072024603836*^9, 3.6370720334538484`*^9}, 3.637072237414134*^9, 
   3.637072303324226*^9, {3.6370728044849277`*^9, 3.637072807354932*^9}, {
   3.6370729608371544`*^9, 3.637073011047225*^9}, {3.6372414491004477`*^9, 
   3.637241450990451*^9}, {3.637241567680627*^9, 3.637241574693149*^9}, {
   3.6372635621523304`*^9, 3.63726358148536*^9}, {3.637263621437416*^9, 
   3.6372637054075356`*^9}, {3.6372637586026106`*^9, 
   3.6372637693846254`*^9}, {3.6372646024325137`*^9, 
   3.6372646045325165`*^9}, {3.6372649246359067`*^9, 3.6372649435289392`*^9}, 
   3.6372651605783095`*^9, {3.6372656730822625`*^9, 3.63726570677919*^9}, {
   3.6372671072282906`*^9, 3.637267112355584*^9}, {3.6372671452714667`*^9, 
   3.637267150700777*^9}, {3.637267190193036*^9, 3.637267211532257*^9}, {
   3.6372672609660845`*^9, 3.6372672759009385`*^9}, {3.63726737121739*^9, 
   3.637267455642219*^9}, {3.6372674994147224`*^9, 3.637267502706911*^9}, {
   3.6372676355795107`*^9, 3.637267642077883*^9}, {3.6372676967870116`*^9, 
   3.6372677287588406`*^9}, {3.63726802597084*^9, 3.6372681066094522`*^9}, {
   3.6372684656889906`*^9, 3.6372684661830187`*^9}, {3.6372685401502495`*^9, 
   3.6372685410543013`*^9}, {3.63726915523143*^9, 3.6372691818799543`*^9}, {
   3.6373205303025727`*^9, 3.637320561287624*^9}, {3.6373219252218313`*^9, 
   3.6373219509438734`*^9}, {3.637352113598833*^9, 3.637352114258834*^9}, {
   3.6742875521396894`*^9, 3.6742876736586895`*^9}, {3.674287718110689*^9, 
   3.6742877858986893`*^9}, {3.6742878601726894`*^9, 
   3.6742878650546894`*^9}, {3.6742879294016895`*^9, 3.674287930892689*^9}, {
   3.674287983664689*^9, 3.6742880286986895`*^9}, {3.674288073471689*^9, 
   3.6742882683396893`*^9}, {3.674288311847689*^9, 3.674288361471689*^9}, {
   3.674288410215689*^9, 3.674288461723689*^9}, {3.674289167637689*^9, 
   3.6742892066206894`*^9}, {3.6742899115696893`*^9, 3.674289918258689*^9}, {
   3.6742900944156895`*^9, 3.674290109446689*^9}, {3.6742901797146893`*^9, 
   3.674290180692689*^9}, {3.674290265428689*^9, 3.6742902906546893`*^9}, {
   3.674290360317689*^9, 3.674290370215689*^9}, {3.6749939306800504`*^9, 
   3.6749939319170604`*^9}, {3.6749940811004744`*^9, 3.674994092986932*^9}, {
   3.674994138118081*^9, 3.674994146085888*^9}, {3.6749955345864506`*^9, 
   3.674995555999687*^9}, {3.6750704083481503`*^9, 3.675070423577298*^9}, 
   3.675070473571554*^9, {3.675072520605866*^9, 3.675072536086192*^9}, 
   3.6750794747241764`*^9, 3.675079541045251*^9, {3.6750796000887165`*^9, 
   3.6750796021333427`*^9}, {3.6750796796045294`*^9, 
   3.6750796931358347`*^9}, {3.675079729274564*^9, 3.675079729483761*^9}, {
   3.6750798178807573`*^9, 3.675079819103448*^9}, {3.6750799072193613`*^9, 
   3.6750799086266003`*^9}, {3.675079944946862*^9, 3.6750799511471024`*^9}, {
   3.6750800392316637`*^9, 3.675080102155428*^9}, {3.6751418510627832`*^9, 
   3.67514187068829*^9}, {3.6751437157493153`*^9, 3.6751437354734373`*^9}, {
   3.6760257212491884`*^9, 3.676025743025861*^9}, {3.677843597458217*^9, 
   3.6778436634868193`*^9}, {3.677844976293087*^9, 3.677845001348592*^9}, {
   3.677845959711419*^9, 3.6778460108045273`*^9}, {3.677923966426543*^9, 
   3.6779239882595434`*^9}, {3.677927591894543*^9, 3.677927770986543*^9}, {
   3.677928231007543*^9, 3.6779282310405436`*^9}, {3.6779296467645435`*^9, 
   3.6779296470145435`*^9}, {3.677931253479543*^9, 3.6779312535305433`*^9}, {
   3.677932887401543*^9, 3.677932916494543*^9}, 3.677932950015543*^9, {
   3.6779337650165434`*^9, 3.6779337998305435`*^9}, {3.678018009255468*^9, 
   3.678018033856826*^9}, {3.678018535298154*^9, 3.678018574909115*^9}, {
   3.678018697954418*^9, 3.6780187243430567`*^9}, {3.6780190230519247`*^9, 
   3.678019025267146*^9}, 3.6780190738620048`*^9, {3.711712880915103*^9, 
   3.711712925322191*^9}, 3.71171300153358*^9, {3.7889942773714275`*^9, 
   3.7889944003001995`*^9}, {3.7889946199384155`*^9, 3.7889946230559654`*^9}, 
   3.7889950903701396`*^9, {3.7920125338329782`*^9, 3.7920125428078327`*^9}, {
   3.792012726299651*^9, 3.7920127344110036`*^9}}],

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", "    ", 
  RowBox[{
   RowBox[{
    RowBox[{"cs", "=", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"angleLam", "[", 
        RowBox[{"[", "im", "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180."}]}], "]"}]}], ";", "\n", "               ", 
    RowBox[{"sn", "=", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"angleLam", "[", 
        RowBox[{"[", "im", "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180."}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "    ", 
    RowBox[{"Tmatrix", " ", "=", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cs", "^", "2"}], ",", " ", 
         RowBox[{"sn", "^", "2"}], ",", "    ", 
         RowBox[{"2", "*", "sn", "*", "cs"}]}], "}"}], " ", ",", " ", 
       "\[IndentingNewLine]", "\t            ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sn", "^", "2"}], ",", "  ", 
         RowBox[{"cs", "^", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "sn", "*", "cs"}]}], "}"}], ",", 
       "\[IndentingNewLine]", "                     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "sn"}], "*", "cs"}], ",", "  ", 
         RowBox[{"sn", "*", "cs"}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cs", "^", "2"}], ")"}], " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"sn", "^", "2"}], ")"}]}]}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"Tmatrixtran", " ", "=", " ", 
     RowBox[{"Transpose", "[", "Tmatrix", "]"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphabarmatrix", " ", "[", 
      RowBox[{"[", 
       RowBox[{"im", ",", "1"}], "]"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"\[Alpha]11", "*", 
       RowBox[{"cs", "^", "2"}]}], "+", 
      RowBox[{"\[Alpha]22", "*", 
       RowBox[{"sn", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphabarmatrix", " ", "[", 
      RowBox[{"[", 
       RowBox[{"im", ",", "2"}], "]"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"\[Alpha]11", "*", 
       RowBox[{"sn", "^", "2"}]}], "+", 
      RowBox[{"\[Alpha]22", "*", 
       RowBox[{"cs", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphabarmatrix", " ", "[", 
      RowBox[{"[", 
       RowBox[{"im", ",", "3"}], "]"}], "]"}], " ", "=", 
     RowBox[{"2", "*", "sn", "*", "cs", "*", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]11", "-", "\[Alpha]22"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "4", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", 
             RowBox[{"im", "+", "1"}], "]"}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", "im", "]"}], "]"}], "^", "2"}]}], ")"}], ")"}]}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "5", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", 
             RowBox[{"im", "+", "1"}], "]"}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", "im", "]"}], "]"}], "^", "2"}]}], ")"}], ")"}]}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "6", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", 
             RowBox[{"im", "+", "1"}], "]"}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", "im", "]"}], "]"}], "^", "2"}]}], ")"}], ")"}]}]}]}],
     ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"im", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<After thermal integration\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5728532938916016`*^9, 3.5728532998515625`*^9}, {
   3.5728533761679688`*^9, 3.572853425008789*^9}, {3.5728534668554688`*^9, 
   3.5728535771953125`*^9}, {3.572853637208008*^9, 3.572853641682617*^9}, {
   3.572853869466797*^9, 3.5728538713583984`*^9}, {3.572854015955078*^9, 
   3.572854020892578*^9}, {3.572945591048828*^9, 3.5729455975966797`*^9}, {
   3.5729456636757812`*^9, 3.5729456693632812`*^9}, {3.5746698575039062`*^9, 
   3.574669876098633*^9}, 3.5746700220751953`*^9, {3.5746702991845703`*^9, 
   3.5746703025595703`*^9}, {3.5746705389472656`*^9, 
   3.5746705402626953`*^9}, {3.634036704603436*^9, 3.634036710818447*^9}, {
   3.634037163829729*^9, 3.6340373030137544`*^9}, {3.6340375427322083`*^9, 
   3.634037564243743*^9}, {3.634037644504654*^9, 3.6340377401565127`*^9}, {
   3.6340378887515583`*^9, 3.6340378987934775`*^9}, {3.6340380721321945`*^9, 
   3.634038134975618*^9}, {3.634038272312996*^9, 3.634038305571559*^9}, {
   3.634038429692766*^9, 3.6340384542288895`*^9}, {3.6340384983954563`*^9, 
   3.6340385064923134`*^9}, {3.634038892166791*^9, 3.634038924385851*^9}, 
   3.6340389691809506`*^9, 3.634039025634086*^9, {3.6340400507632165`*^9, 
   3.6340400516282187`*^9}, 3.6340402780794725`*^9, {3.6340403088335047`*^9, 
   3.6340403089305096`*^9}, {3.634040591333089*^9, 3.634040605808111*^9}, {
   3.634040739457316*^9, 3.6340407987504063`*^9}, {3.6340410644988413`*^9, 
   3.6340410665908456`*^9}, {3.634041101583902*^9, 3.6340411031939044`*^9}, {
   3.634041490703528*^9, 3.634041492806532*^9}, {3.6340416786641364`*^9, 
   3.6340416812861404`*^9}, {3.6340417201562014`*^9, 3.634041748995245*^9}, {
   3.6340424804687233`*^9, 3.6340424869637337`*^9}, {3.634042678493037*^9, 
   3.634042686904052*^9}, {3.634042829709272*^9, 3.634042875080358*^9}, {
   3.6340429591914854`*^9, 3.6340430393046193`*^9}, {3.6342993100947437`*^9, 
   3.6342993113347454`*^9}, 3.6342999015998864`*^9, 3.634300023906088*^9, {
   3.634300091829245*^9, 3.6343001315793395`*^9}, {3.6343001859674687`*^9, 
   3.6343002460736146`*^9}, 3.6343012695307436`*^9, {3.6343012998288136`*^9, 
   3.634301300122814*^9}, {3.6343017328833303`*^9, 3.634301735301445*^9}, {
   3.63430195189984*^9, 3.6343019552388487`*^9}, 3.634302055559372*^9, 
   3.6343021222080936`*^9, {3.6343030824527297`*^9, 3.6343030949689894`*^9}, {
   3.634303800034294*^9, 3.6343038060343103`*^9}, 3.634304033004777*^9, {
   3.6343067362375402`*^9, 3.634306742979557*^9}, {3.6343070273368835`*^9, 
   3.63430703641391*^9}, {3.6343071980482597`*^9, 3.634307233160331*^9}, 
   3.6343074959820695`*^9, {3.6343075626396227`*^9, 3.634307576310732*^9}, {
   3.6343078124406595`*^9, 3.634307820280795*^9}, {3.634308105317828*^9, 
   3.634308108620885*^9}, {3.6343232463278627`*^9, 3.634323246547863*^9}, {
   3.6343234260182467`*^9, 3.634323430258253*^9}, {3.634329468145095*^9, 
   3.634329474005103*^9}, {3.6343297967814093`*^9, 3.634329801701416*^9}, {
   3.6343758393864503`*^9, 3.6343758596238832`*^9}, {3.6343761136003995`*^9, 
   3.6343761147904267`*^9}, {3.6343762276307626`*^9, 3.634376233115875*^9}, {
   3.6343763701062174`*^9, 3.6343763713982763`*^9}, {3.6343766451139383`*^9, 
   3.634376645935976*^9}, {3.6343767800008326`*^9, 3.6343767896973085`*^9}, {
   3.6370569622356625`*^9, 3.6370569677956705`*^9}, 3.637071990413788*^9, {
   3.637072024603836*^9, 3.6370720334538484`*^9}, 3.637072237414134*^9, 
   3.637072303324226*^9, {3.6370728044849277`*^9, 3.637072807354932*^9}, {
   3.6370729608371544`*^9, 3.637073011047225*^9}, {3.6372414491004477`*^9, 
   3.637241450990451*^9}, {3.637241567680627*^9, 3.637241574693149*^9}, {
   3.6372635621523304`*^9, 3.63726358148536*^9}, {3.637263621437416*^9, 
   3.6372637054075356`*^9}, {3.6372637586026106`*^9, 
   3.6372637693846254`*^9}, {3.6372646024325137`*^9, 
   3.6372646045325165`*^9}, {3.6372649246359067`*^9, 3.6372649435289392`*^9}, 
   3.6372651605783095`*^9, {3.6372656730822625`*^9, 3.63726570677919*^9}, {
   3.6372671072282906`*^9, 3.637267112355584*^9}, {3.6372671452714667`*^9, 
   3.637267150700777*^9}, {3.637267190193036*^9, 3.637267211532257*^9}, {
   3.6372672609660845`*^9, 3.6372672759009385`*^9}, {3.63726737121739*^9, 
   3.637267455642219*^9}, {3.6372674994147224`*^9, 3.637267502706911*^9}, {
   3.6372676355795107`*^9, 3.637267642077883*^9}, {3.6372676967870116`*^9, 
   3.6372677287588406`*^9}, {3.63726802597084*^9, 3.6372681066094522`*^9}, {
   3.6372684656889906`*^9, 3.6372684661830187`*^9}, {3.6372685401502495`*^9, 
   3.6372685410543013`*^9}, {3.63726915523143*^9, 3.6372691818799543`*^9}, {
   3.6373205303025727`*^9, 3.637320561287624*^9}, {3.6373219252218313`*^9, 
   3.6373219509438734`*^9}, {3.637352113598833*^9, 3.637352114258834*^9}, {
   3.6742875521396894`*^9, 3.6742876736586895`*^9}, {3.674287718110689*^9, 
   3.6742877858986893`*^9}, {3.6742878601726894`*^9, 
   3.6742878650546894`*^9}, {3.6742879294016895`*^9, 3.674287930892689*^9}, {
   3.674287983664689*^9, 3.6742880286986895`*^9}, {3.674288073471689*^9, 
   3.6742882683396893`*^9}, {3.674288311847689*^9, 3.674288361471689*^9}, {
   3.674288410215689*^9, 3.674288461723689*^9}, {3.674289167637689*^9, 
   3.6742892066206894`*^9}, {3.6742899115696893`*^9, 3.674289918258689*^9}, {
   3.6742900944156895`*^9, 3.674290109446689*^9}, {3.6742901797146893`*^9, 
   3.674290180692689*^9}, {3.674290265428689*^9, 3.6742902906546893`*^9}, {
   3.674290360317689*^9, 3.674290370215689*^9}, {3.6749939306800504`*^9, 
   3.6749939319170604`*^9}, {3.6749940811004744`*^9, 3.674994092986932*^9}, {
   3.674994138118081*^9, 3.674994146085888*^9}, {3.6749955345864506`*^9, 
   3.674995555999687*^9}, {3.6750704083481503`*^9, 3.675070423577298*^9}, 
   3.675070473571554*^9, {3.675072520605866*^9, 3.675072536086192*^9}, 
   3.6750794747241764`*^9, 3.675079541045251*^9, {3.6750796000887165`*^9, 
   3.6750796021333427`*^9}, {3.6750796796045294`*^9, 
   3.6750796931358347`*^9}, {3.675079729274564*^9, 3.675079729483761*^9}, {
   3.6750798178807573`*^9, 3.675079819103448*^9}, {3.6750799072193613`*^9, 
   3.6750799086266003`*^9}, {3.675079944946862*^9, 3.6750799511471024`*^9}, {
   3.6750800392316637`*^9, 3.675080102155428*^9}, {3.6751418510627832`*^9, 
   3.67514187068829*^9}, {3.6751437157493153`*^9, 3.6751437354734373`*^9}, {
   3.6760257212491884`*^9, 3.676025743025861*^9}, {3.677843597458217*^9, 
   3.6778436634868193`*^9}, {3.677844976293087*^9, 3.677845001348592*^9}, {
   3.677845959711419*^9, 3.6778460108045273`*^9}, {3.677923966426543*^9, 
   3.6779239882595434`*^9}, {3.677927591894543*^9, 3.677927770986543*^9}, {
   3.677928231007543*^9, 3.6779282310405436`*^9}, {3.6779296467645435`*^9, 
   3.6779296470145435`*^9}, {3.677931253479543*^9, 3.6779312535305433`*^9}, {
   3.677932887401543*^9, 3.677932916494543*^9}, 3.677932950015543*^9, {
   3.6779337650165434`*^9, 3.6779337998305435`*^9}, {3.678018009255468*^9, 
   3.678018033856826*^9}, {3.678018535298154*^9, 3.678018574909115*^9}, {
   3.678018697954418*^9, 3.6780187243430567`*^9}, {3.6780190230519247`*^9, 
   3.678019025267146*^9}, 3.6780190738620048`*^9, {3.711712880915103*^9, 
   3.711712925322191*^9}, 3.71171300153358*^9, {3.7889942773714275`*^9, 
   3.7889944003001995`*^9}, {3.7889946199384155`*^9, 3.7889946230559654`*^9}, 
   3.7889950903701396`*^9, {3.7920125338329782`*^9, 3.7920125428078327`*^9}, {
   3.792012726299651*^9, 3.7920127344110036`*^9}, {3.7921381969204416`*^9, 
   3.7921382178504515`*^9}, {3.792138294303588*^9, 3.7921382957597523`*^9}, {
   3.7921385672837467`*^9, 3.7921386309260893`*^9}, {3.792138690213148*^9, 
   3.7921387241280007`*^9}, {3.792138796217847*^9, 3.7921388300066657`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Q", "*", 
    RowBox[{"(", 
     RowBox[{"z0", "-", 
      RowBox[{"(", 
       FractionBox[
        RowBox[{
         RowBox[{"2", "*", "t0"}], "+", "tm"}], "2"], ")"}]}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "t"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8006132926090794`*^9, 3.800613346971712*^9}}],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"Q", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "t0"}], "-", "tm"}], ")"}]}], "+", "z0"}], 
     ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "t"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.800613334437867*^9, 3.800613347823228*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ThermalFM", "//", "Chop"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.79213837895268*^9, 3.792138380897567*^9}, {
  3.7921387829254637`*^9, 3.79213878476241*^9}, {3.7921389588402452`*^9, 
  3.7921389605432653`*^9}, {3.7921390165536237`*^9, 3.792139043976958*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]11", " ", "\[Beta]", " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[VeryThinSpace]", "+", 
             RowBox[{"1.`", " ", "\[Nu]"}]}], ")"}]}], "+", 
          RowBox[{"\[Alpha]22", " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[VeryThinSpace]", "+", 
             RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
         ")"}]}]},
      {
       RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]11", " ", "\[Beta]", " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[VeryThinSpace]", "+", 
             RowBox[{"1.`", " ", "\[Nu]"}]}], ")"}]}], "+", 
          RowBox[{"\[Alpha]22", " ", 
           RowBox[{"(", 
            RowBox[{"1.`", "\[VeryThinSpace]", "+", 
             RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
         ")"}]}]},
      {"0"},
      {
       RowBox[{"E0", " ", 
        SuperscriptBox["h", "2"], " ", "\[CapitalDelta]T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]11", " ", "\[Beta]", " ", 
           RowBox[{"(", 
            RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
          RowBox[{"\[Alpha]22", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.5`"}], "+", 
             RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
         ")"}]}]},
      {
       RowBox[{"E0", " ", 
        SuperscriptBox["h", "2"], " ", "\[CapitalDelta]T", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]11", " ", "\[Beta]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.5`"}], "+", 
             RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
          RowBox[{"\[Alpha]22", " ", 
           RowBox[{"(", 
            RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
             RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
         ")"}]}]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.792138381579176*^9, 3.792138525267806*^9, 3.792138603475285*^9, 
   3.7921386417295027`*^9, {3.792138775035983*^9, 3.79213878558294*^9}, {
   3.7921388344311366`*^9, 3.792138843379011*^9}, {3.7921389479392896`*^9, 
   3.7921389609930086`*^9}, {3.7921390189182677`*^9, 3.7921390447625074`*^9}, 
   3.800568691807384*^9, 3.8005687338988333`*^9, 3.8005688063735533`*^9, 
   3.8005689319304037`*^9, 3.800572742663596*^9, 3.800572777533695*^9, 
   3.8006064020500727`*^9, 3.8006064665165577`*^9, 3.8006087448975124`*^9, 
   3.800608793349861*^9, 3.8006112238862486`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"0.5", "*", "E0", "*", "\[CapitalDelta]T", "*", 
     SuperscriptBox["h", "2"], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Alpha]11"}], "+", 
       RowBox[{"\[Beta]", "*", "\[Alpha]22"}], "+", 
       RowBox[{"\[Nu]", "*", "\[Beta]", "*", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]11", "-", "\[Alpha]22"}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"ThermalFM", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], " ", "//", "Simplify"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.8006088800753684`*^9, 3.80060890821731*^9}, {
  3.8006089686628494`*^9, 3.8006089861338787`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.8006089089988613`*^9, {3.8006089734311275`*^9, 3.8006089865866194`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"E0", " ", 
     SuperscriptBox["h", "2"], " ", "\[CapitalDelta]T", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]11", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "+", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}], "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "0.5"}], "*", "E0", "*", "\[CapitalDelta]T", "*", 
      SuperscriptBox["t", "2"], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Alpha]11"}], "+", 
        RowBox[{"\[Beta]", "*", "\[Alpha]22"}], "+", 
        RowBox[{"\[Nu]", "*", "\[Beta]", "*", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]11", "-", "\[Alpha]22"}], ")"}]}]}], ")"}]}], 
     ")"}]}], "//", "Expand"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7921390654597464`*^9, 3.7921390829686437`*^9}, {
  3.800606518032159*^9, 3.80060658536773*^9}}],

Cell[BoxData[
 RowBox[{"E0", " ", "\[CapitalDelta]T", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["t", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "+", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["h", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]11", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "+", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.792139071342371*^9, 3.7921390835163245`*^9}, {
  3.8006065206906404`*^9, 3.8006065509563694`*^9}, {3.8006065811511364`*^9, 
  3.8006065858524523`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThermalFM", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "0.5"}], "*", "E0", "*", "\[CapitalDelta]T", "*", 
      SuperscriptBox["h", "2"], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[Alpha]11"}], "+", 
        RowBox[{"\[Beta]", "*", "\[Alpha]22"}], "+", 
        RowBox[{"\[Nu]", "*", "\[Beta]", "*", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]11", "-", "\[Alpha]22"}], ")"}]}]}], ")"}]}], 
     ")"}]}], "//", "Expand"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.7921390094581814`*^9, 3.7921390138286753`*^9}, {
  3.792139134569843*^9, 3.7921391469642305`*^9}, {3.800572852316515*^9, 
  3.800572881003148*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.792139141153073*^9, 3.792139147568883*^9}, {
  3.8005728606387663`*^9, 3.8005728818356676`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.`"}], "-", 
          RowBox[{"1.`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.`"}], "-", 
          RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], ")"}]}],
     "-", 
    RowBox[{"(", 
     RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.`"}], "-", 
           RowBox[{"1.`", " ", "\[Nu]"}]}], ")"}]}], "+", 
        RowBox[{"\[Alpha]11", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.`"}], "-", 
           RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
       ")"}]}], ")"}]}], "//", "Expand"}], " ", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8005697464392004`*^9, 3.8005697741510286`*^9}, 
   3.8005699674811544`*^9, {3.800570021243642*^9, 3.8005700469631214`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.800569751099892*^9, 3.800569774668004*^9}, 
   3.80056996820535*^9, {3.8005700358669395`*^9, 3.800570047669272*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"-", "0.5"}], "*", "E0", "*", "\[CapitalDelta]T", "*", 
    SuperscriptBox["t", "2"], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[Alpha]11"}], "+", 
      RowBox[{"\[Beta]", "*", "\[Alpha]22"}], "+", 
      RowBox[{"\[Nu]", "*", "\[Beta]", "*", 
       RowBox[{"(", 
        RowBox[{"\[Alpha]11", "-", "\[Alpha]22"}], ")"}]}]}], ")"}]}], "-", 
   RowBox[{"(", 
    RowBox[{"E0", " ", 
     SuperscriptBox["t", "2"], " ", "\[CapitalDelta]T", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "+", 
          RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{"0.5`", "\[VeryThinSpace]", "-", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}], ")"}]}], " ", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.800569984474016*^9, 3.8005700114259357`*^9}, 
   3.800570058743083*^9, {3.800570382483037*^9, 3.8005703913459*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.800569980542571*^9, 3.8005700119309855`*^9}, 
   3.8005700607583838`*^9, {3.800570384026444*^9, 3.800570392392086*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q0", " ", "=", 
   RowBox[{"E0", "*", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", " ", 
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "\[Beta]", ",", "0"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Gamma]"}], "}"}]}], "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Q90", " ", "=", 
   RowBox[{"E0", "*", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", " ", 
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Beta]", "*", "\[Nu]"}], ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Gamma]"}], "}"}]}], "}"}]}]}], 
  ";"}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"angleLam", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "90"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"h", ",", "0", ",", 
      RowBox[{"-", "h"}]}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Qbarmatrix", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", " ", 
     RowBox[{"{", "3", "}"}], ",", " ", 
     RowBox[{"{", "3", "}"}]}], "]"}]}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Qbarmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All"}], "]"}], "]"}], " ", "=", " ", "Q0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Qbarmatrix", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "All"}], "]"}], "]"}], " ", "=", " ", "Q90"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"alphabarmatrix", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", " ", 
     RowBox[{"{", "3", "}"}], ",", " ", 
     RowBox[{"{", "1", "}"}]}], "]"}]}], " ", ";", " ", 
  RowBox[{"(*", 
   RowBox[{
   "initialization", " ", "of", " ", "alpha", " ", "in", " ", "global", " ", 
    "for", " ", "each", " ", "lamina"}], "*)"}], "\n", 
  RowBox[{"ThermalFM", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7921382300444627`*^9, 3.7921382413270025`*^9}, {
  3.7921383558838987`*^9, 3.7921383694071503`*^9}, {3.800570640874222*^9, 
  3.800570660680381*^9}, {3.8006063854665365`*^9, 3.80060638705663*^9}, {
  3.800606679788083*^9, 3.800606698283527*^9}, {3.8006112069299264`*^9, 
  3.800611209181642*^9}, {3.8006140089739084`*^9, 3.8006140145936985`*^9}, {
  3.800614103550931*^9, 3.8006141132344055`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Do", "[", "\[IndentingNewLine]", "    ", 
  RowBox[{
   RowBox[{
    RowBox[{"cs", "=", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"angleLam", "[", 
        RowBox[{"[", "im", "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180."}]}], "]"}]}], ";", "\n", "               ", 
    RowBox[{"sn", "=", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"angleLam", "[", 
        RowBox[{"[", "im", "]"}], "]"}], "*", 
       RowBox[{"Pi", "/", "180."}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "    ", 
    RowBox[{"Tmatrix", " ", "=", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cs", "^", "2"}], ",", " ", 
         RowBox[{"sn", "^", "2"}], ",", "    ", 
         RowBox[{"2", "*", "sn", "*", "cs"}]}], "}"}], " ", ",", " ", 
       "\[IndentingNewLine]", "\t            ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"sn", "^", "2"}], ",", "  ", 
         RowBox[{"cs", "^", "2"}], ",", " ", 
         RowBox[{
          RowBox[{"-", "2"}], "*", "sn", "*", "cs"}]}], "}"}], ",", 
       "\[IndentingNewLine]", "                     ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "sn"}], "*", "cs"}], ",", "  ", 
         RowBox[{"sn", "*", "cs"}], ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"cs", "^", "2"}], ")"}], " ", "-", " ", 
          RowBox[{"(", 
           RowBox[{"sn", "^", "2"}], ")"}]}]}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"Tmatrixtran", " ", "=", " ", 
     RowBox[{"Transpose", "[", "Tmatrix", "]"}]}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphabarmatrix", " ", "[", 
      RowBox[{"[", 
       RowBox[{"im", ",", "1"}], "]"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"\[Alpha]11", "*", 
       RowBox[{"cs", "^", "2"}]}], "+", 
      RowBox[{"\[Alpha]22", "*", 
       RowBox[{"sn", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphabarmatrix", " ", "[", 
      RowBox[{"[", 
       RowBox[{"im", ",", "2"}], "]"}], "]"}], " ", "=", 
     RowBox[{
      RowBox[{"\[Alpha]11", "*", 
       RowBox[{"sn", "^", "2"}]}], "+", 
      RowBox[{"\[Alpha]22", "*", 
       RowBox[{"cs", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"alphabarmatrix", " ", "[", 
      RowBox[{"[", 
       RowBox[{"im", ",", "3"}], "]"}], "]"}], " ", "=", 
     RowBox[{"2", "*", "sn", "*", "cs", "*", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]11", "-", "\[Alpha]22"}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "4", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "h"}], "+", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}], "+", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], " ", "-", "tm"}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "5", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "h"}], "+", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}], "+", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], " ", "-", "tm"}], 
        ")"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ThermalFM", " ", "[", 
      RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"ThermalFM", " ", "[", 
       RowBox[{"[", "6", "]"}], "]"}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "1"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "1"}], "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "2"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "2"}], "]"}], "]"}]}], " ", "+", " ", 
         RowBox[{
          RowBox[{"Qbarmatrix", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3", ",", "3"}], "]"}], "]"}], "*", 
          RowBox[{"alphabarmatrix", " ", "[", 
           RowBox[{"[", 
            RowBox[{"im", ",", "3"}], "]"}], "]"}]}]}], " ", ")"}], "*", 
       "\[CapitalDelta]T", "*", "0.5", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}], "-", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "h"}], "+", 
         RowBox[{"z", "[", 
          RowBox[{"[", "im", "]"}], "]"}], "+", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"im", "+", "1"}], "]"}], "]"}], " ", "-", "tm"}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"im", ",", "1", ",", "2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "\"\<After thermal integration\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.5728532938916016`*^9, 3.5728532998515625`*^9}, {
   3.5728533761679688`*^9, 3.572853425008789*^9}, {3.5728534668554688`*^9, 
   3.5728535771953125`*^9}, {3.572853637208008*^9, 3.572853641682617*^9}, {
   3.572853869466797*^9, 3.5728538713583984`*^9}, {3.572854015955078*^9, 
   3.572854020892578*^9}, {3.572945591048828*^9, 3.5729455975966797`*^9}, {
   3.5729456636757812`*^9, 3.5729456693632812`*^9}, {3.5746698575039062`*^9, 
   3.574669876098633*^9}, 3.5746700220751953`*^9, {3.5746702991845703`*^9, 
   3.5746703025595703`*^9}, {3.5746705389472656`*^9, 
   3.5746705402626953`*^9}, {3.634036704603436*^9, 3.634036710818447*^9}, {
   3.634037163829729*^9, 3.6340373030137544`*^9}, {3.6340375427322083`*^9, 
   3.634037564243743*^9}, {3.634037644504654*^9, 3.6340377401565127`*^9}, {
   3.6340378887515583`*^9, 3.6340378987934775`*^9}, {3.6340380721321945`*^9, 
   3.634038134975618*^9}, {3.634038272312996*^9, 3.634038305571559*^9}, {
   3.634038429692766*^9, 3.6340384542288895`*^9}, {3.6340384983954563`*^9, 
   3.6340385064923134`*^9}, {3.634038892166791*^9, 3.634038924385851*^9}, 
   3.6340389691809506`*^9, 3.634039025634086*^9, {3.6340400507632165`*^9, 
   3.6340400516282187`*^9}, 3.6340402780794725`*^9, {3.6340403088335047`*^9, 
   3.6340403089305096`*^9}, {3.634040591333089*^9, 3.634040605808111*^9}, {
   3.634040739457316*^9, 3.6340407987504063`*^9}, {3.6340410644988413`*^9, 
   3.6340410665908456`*^9}, {3.634041101583902*^9, 3.6340411031939044`*^9}, {
   3.634041490703528*^9, 3.634041492806532*^9}, {3.6340416786641364`*^9, 
   3.6340416812861404`*^9}, {3.6340417201562014`*^9, 3.634041748995245*^9}, {
   3.6340424804687233`*^9, 3.6340424869637337`*^9}, {3.634042678493037*^9, 
   3.634042686904052*^9}, {3.634042829709272*^9, 3.634042875080358*^9}, {
   3.6340429591914854`*^9, 3.6340430393046193`*^9}, {3.6342993100947437`*^9, 
   3.6342993113347454`*^9}, 3.6342999015998864`*^9, 3.634300023906088*^9, {
   3.634300091829245*^9, 3.6343001315793395`*^9}, {3.6343001859674687`*^9, 
   3.6343002460736146`*^9}, 3.6343012695307436`*^9, {3.6343012998288136`*^9, 
   3.634301300122814*^9}, {3.6343017328833303`*^9, 3.634301735301445*^9}, {
   3.63430195189984*^9, 3.6343019552388487`*^9}, 3.634302055559372*^9, 
   3.6343021222080936`*^9, {3.6343030824527297`*^9, 3.6343030949689894`*^9}, {
   3.634303800034294*^9, 3.6343038060343103`*^9}, 3.634304033004777*^9, {
   3.6343067362375402`*^9, 3.634306742979557*^9}, {3.6343070273368835`*^9, 
   3.63430703641391*^9}, {3.6343071980482597`*^9, 3.634307233160331*^9}, 
   3.6343074959820695`*^9, {3.6343075626396227`*^9, 3.634307576310732*^9}, {
   3.6343078124406595`*^9, 3.634307820280795*^9}, {3.634308105317828*^9, 
   3.634308108620885*^9}, {3.6343232463278627`*^9, 3.634323246547863*^9}, {
   3.6343234260182467`*^9, 3.634323430258253*^9}, {3.634329468145095*^9, 
   3.634329474005103*^9}, {3.6343297967814093`*^9, 3.634329801701416*^9}, {
   3.6343758393864503`*^9, 3.6343758596238832`*^9}, {3.6343761136003995`*^9, 
   3.6343761147904267`*^9}, {3.6343762276307626`*^9, 3.634376233115875*^9}, {
   3.6343763701062174`*^9, 3.6343763713982763`*^9}, {3.6343766451139383`*^9, 
   3.634376645935976*^9}, {3.6343767800008326`*^9, 3.6343767896973085`*^9}, {
   3.6370569622356625`*^9, 3.6370569677956705`*^9}, 3.637071990413788*^9, {
   3.637072024603836*^9, 3.6370720334538484`*^9}, 3.637072237414134*^9, 
   3.637072303324226*^9, {3.6370728044849277`*^9, 3.637072807354932*^9}, {
   3.6370729608371544`*^9, 3.637073011047225*^9}, {3.6372414491004477`*^9, 
   3.637241450990451*^9}, {3.637241567680627*^9, 3.637241574693149*^9}, {
   3.6372635621523304`*^9, 3.63726358148536*^9}, {3.637263621437416*^9, 
   3.6372637054075356`*^9}, {3.6372637586026106`*^9, 
   3.6372637693846254`*^9}, {3.6372646024325137`*^9, 
   3.6372646045325165`*^9}, {3.6372649246359067`*^9, 3.6372649435289392`*^9}, 
   3.6372651605783095`*^9, {3.6372656730822625`*^9, 3.63726570677919*^9}, {
   3.6372671072282906`*^9, 3.637267112355584*^9}, {3.6372671452714667`*^9, 
   3.637267150700777*^9}, {3.637267190193036*^9, 3.637267211532257*^9}, {
   3.6372672609660845`*^9, 3.6372672759009385`*^9}, {3.63726737121739*^9, 
   3.637267455642219*^9}, {3.6372674994147224`*^9, 3.637267502706911*^9}, {
   3.6372676355795107`*^9, 3.637267642077883*^9}, {3.6372676967870116`*^9, 
   3.6372677287588406`*^9}, {3.63726802597084*^9, 3.6372681066094522`*^9}, {
   3.6372684656889906`*^9, 3.6372684661830187`*^9}, {3.6372685401502495`*^9, 
   3.6372685410543013`*^9}, {3.63726915523143*^9, 3.6372691818799543`*^9}, {
   3.6373205303025727`*^9, 3.637320561287624*^9}, {3.6373219252218313`*^9, 
   3.6373219509438734`*^9}, {3.637352113598833*^9, 3.637352114258834*^9}, {
   3.6742875521396894`*^9, 3.6742876736586895`*^9}, {3.674287718110689*^9, 
   3.6742877858986893`*^9}, {3.6742878601726894`*^9, 
   3.6742878650546894`*^9}, {3.6742879294016895`*^9, 3.674287930892689*^9}, {
   3.674287983664689*^9, 3.6742880286986895`*^9}, {3.674288073471689*^9, 
   3.6742882683396893`*^9}, {3.674288311847689*^9, 3.674288361471689*^9}, {
   3.674288410215689*^9, 3.674288461723689*^9}, {3.674289167637689*^9, 
   3.6742892066206894`*^9}, {3.6742899115696893`*^9, 3.674289918258689*^9}, {
   3.6742900944156895`*^9, 3.674290109446689*^9}, {3.6742901797146893`*^9, 
   3.674290180692689*^9}, {3.674290265428689*^9, 3.6742902906546893`*^9}, {
   3.674290360317689*^9, 3.674290370215689*^9}, {3.6749939306800504`*^9, 
   3.6749939319170604`*^9}, {3.6749940811004744`*^9, 3.674994092986932*^9}, {
   3.674994138118081*^9, 3.674994146085888*^9}, {3.6749955345864506`*^9, 
   3.674995555999687*^9}, {3.6750704083481503`*^9, 3.675070423577298*^9}, 
   3.675070473571554*^9, {3.675072520605866*^9, 3.675072536086192*^9}, 
   3.6750794747241764`*^9, 3.675079541045251*^9, {3.6750796000887165`*^9, 
   3.6750796021333427`*^9}, {3.6750796796045294`*^9, 
   3.6750796931358347`*^9}, {3.675079729274564*^9, 3.675079729483761*^9}, {
   3.6750798178807573`*^9, 3.675079819103448*^9}, {3.6750799072193613`*^9, 
   3.6750799086266003`*^9}, {3.675079944946862*^9, 3.6750799511471024`*^9}, {
   3.6750800392316637`*^9, 3.675080102155428*^9}, {3.6751418510627832`*^9, 
   3.67514187068829*^9}, {3.6751437157493153`*^9, 3.6751437354734373`*^9}, {
   3.6760257212491884`*^9, 3.676025743025861*^9}, {3.677843597458217*^9, 
   3.6778436634868193`*^9}, {3.677844976293087*^9, 3.677845001348592*^9}, {
   3.677845959711419*^9, 3.6778460108045273`*^9}, {3.677923966426543*^9, 
   3.6779239882595434`*^9}, {3.677927591894543*^9, 3.677927770986543*^9}, {
   3.677928231007543*^9, 3.6779282310405436`*^9}, {3.6779296467645435`*^9, 
   3.6779296470145435`*^9}, {3.677931253479543*^9, 3.6779312535305433`*^9}, {
   3.677932887401543*^9, 3.677932916494543*^9}, 3.677932950015543*^9, {
   3.6779337650165434`*^9, 3.6779337998305435`*^9}, {3.678018009255468*^9, 
   3.678018033856826*^9}, {3.678018535298154*^9, 3.678018574909115*^9}, {
   3.678018697954418*^9, 3.6780187243430567`*^9}, {3.6780190230519247`*^9, 
   3.678019025267146*^9}, 3.6780190738620048`*^9, {3.711712880915103*^9, 
   3.711712925322191*^9}, 3.71171300153358*^9, {3.7889942773714275`*^9, 
   3.7889944003001995`*^9}, {3.7889946199384155`*^9, 3.7889946230559654`*^9}, 
   3.7889950903701396`*^9, {3.7920125338329782`*^9, 3.7920125428078327`*^9}, {
   3.792012726299651*^9, 3.7920127344110036`*^9}, {3.7921381969204416`*^9, 
   3.7921382178504515`*^9}, {3.792138294303588*^9, 3.7921382957597523`*^9}, {
   3.7921385672837467`*^9, 3.7921386309260893`*^9}, {3.792138690213148*^9, 
   3.7921387241280007`*^9}, {3.792138796217847*^9, 3.7921388300066657`*^9}, {
   3.800613579069002*^9, 3.800613695185732*^9}, {3.800613728049977*^9, 
   3.8006137331540647`*^9}}],

Cell[BoxData["\<\"After thermal integration\"\>"], "Print",
 CellChangeTimes->{
  3.8006137402540116`*^9, 3.800614030086856*^9, {3.8006141224601393`*^9, 
   3.8006141458607087`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ThermalFM", "//", "Simplify"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.8006137453770885`*^9, 3.8006137613030005`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1.`"}], "-", 
         RowBox[{"1.`", " ", "\[Nu]"}]}], ")"}]}], "+", 
      RowBox[{"\[Alpha]11", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1.`"}], "-", 
         RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], ")"}]}], 
   ",", 
   RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Alpha]11", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1.`"}], "-", 
         RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}], "+", 
      RowBox[{"\[Alpha]22", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1.`"}], " ", "\[Beta]"}], "-", 
         RowBox[{"1.`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], ")"}]}], 
   ",", "0", ",", 
   RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1.5`"}], "-", 
            RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
         RowBox[{"\[Alpha]11", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "0.5`"}], "-", 
            RowBox[{"1.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"tm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "0.5`"}], "-", 
            RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
         RowBox[{"\[Alpha]11", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "0.5`"}], "-", 
            RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ",", 
   RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]22", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.5`"}], " ", "\[Beta]"}], "-", 
            RowBox[{"1.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}], "+", 
         RowBox[{"\[Alpha]11", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1.5`"}], "-", 
            RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"tm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Alpha]11", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "0.5`"}], "-", 
            RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}], "+", 
         RowBox[{"\[Alpha]22", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.5`"}], " ", "\[Beta]"}], "-", 
            RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.8006137488591022`*^9, 3.8006137619336395`*^9}, 
   3.800614033362986*^9, 3.8006141487590556`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ThermalFM", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "//", "Simplify"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.8006137894369473`*^9, 3.8006138005066257`*^9}, {
  3.8006138737648544`*^9, 3.800613912564172*^9}, {3.800614040301027*^9, 
  3.800614055421401*^9}}],

Cell[BoxData[
 RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"h", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.5`"}], "-", 
          RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "-", 
          RowBox[{"1.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"tm", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]22", " ", "\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "-", 
          RowBox[{"0.5`", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "-", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.8006137910100446`*^9, 3.800613801314164*^9}, {
   3.800613886949333*^9, 3.8006139134536605`*^9}, {3.8006140379293804`*^9, 
   3.800614056126995*^9}, 3.800614152607857*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ThermalFM", "[", 
    RowBox[{"[", "5", "]"}], "]"}], "//", "Simplify"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.8006141587893333`*^9, 3.8006141598917017`*^9}}],

Cell[BoxData[
 RowBox[{"E0", " ", "h", " ", "\[CapitalDelta]T", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"h", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.5`"}], " ", "\[Beta]"}], "-", 
          RowBox[{"1.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.5`"}], "-", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}], "+", 
    RowBox[{"tm", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Alpha]11", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.5`"}], "-", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}], "+", 
       RowBox[{"\[Alpha]22", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "0.5`"}], " ", "\[Beta]"}], "-", 
          RowBox[{"0.5`", " ", "\[Beta]", " ", "\[Nu]"}]}], ")"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8006141605863047`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ThermalFM", "[", 
    RowBox[{"[", "6", "]"}], "]"}], "//", "Simplify"}], "//", 
  "Chop"}]], "Input",
 CellChangeTimes->{{3.800614166595875*^9, 3.8006141711402817`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.8006141675403357`*^9, 3.800614171933829*^9}}]
}, Open  ]]
},
Evaluator->"newlocal",
WindowSize->{1244, 981},
WindowMargins->{{73, Automatic}, {Automatic, 0}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 6300, 182, 227, "Input"],
Cell[6861, 204, 1003, 30, 114, "Input"],
Cell[7867, 236, 220, 6, 62, "Input"],
Cell[8090, 244, 1359, 35, 62, "Input"],
Cell[CellGroupData[{
Cell[9474, 283, 173, 3, 37, "Input"],
Cell[9650, 288, 926, 25, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10613, 318, 588, 14, 37, "Input"],
Cell[11204, 334, 235, 7, 54, "Output"]
}, Open  ]],
Cell[11454, 344, 1079, 28, 71, "Input"],
Cell[CellGroupData[{
Cell[12558, 376, 505, 15, 41, "Input"],
Cell[13066, 393, 258, 9, 71, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13361, 407, 369, 10, 62, "Input"],
Cell[13733, 419, 365, 9, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14135, 433, 136, 2, 37, "Input"],
Cell[14274, 437, 139, 3, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14450, 445, 535, 10, 62, "Input"],
Cell[14988, 457, 331, 9, 37, "Output"],
Cell[15322, 468, 332, 9, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15691, 482, 697, 21, 37, "Input"],
Cell[16391, 505, 1026, 28, 74, "Output"]
}, Open  ]],
Cell[17432, 536, 663, 14, 62, "Input"],
Cell[CellGroupData[{
Cell[18120, 554, 96, 3, 57, "Input"],
Cell[18219, 559, 189, 6, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18445, 570, 150, 3, 37, "Input"],
Cell[18598, 575, 125, 2, 37, "Output"]
}, Open  ]],
Cell[18738, 580, 7648, 106, 37, "Input"],
Cell[26389, 688, 471, 14, 62, "Input"],
Cell[26863, 704, 7889, 112, 37, "Input"],
Cell[34755, 818, 7538, 104, 37, "Input"],
Cell[42296, 924, 19532, 423, 1070, "Input"],
Cell[CellGroupData[{
Cell[61853, 1351, 392, 12, 57, "Input"],
Cell[62248, 1365, 451, 15, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62736, 1385, 349, 7, 37, "Input"],
Cell[63088, 1394, 3351, 84, 155, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66476, 1483, 663, 17, 37, "Input"],
Cell[67142, 1502, 125, 2, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67304, 1509, 1153, 31, 66, "Input"],
Cell[68460, 1542, 1225, 34, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69722, 1581, 765, 20, 41, "Input"],
Cell[70490, 1603, 147, 2, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70674, 1610, 1248, 34, 62, "Input"],
Cell[71925, 1646, 167, 2, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72129, 1653, 1121, 29, 66, "Input"],
Cell[73253, 1684, 172, 2, 37, "Output"]
}, Open  ]],
Cell[73440, 1689, 910, 29, 62, "Input"],
Cell[74353, 1720, 1856, 50, 206, "Input"],
Cell[CellGroupData[{
Cell[76234, 1774, 20285, 443, 1142, "Input"],
Cell[96522, 2219, 182, 3, 26, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96741, 2227, 162, 3, 37, "Input"],
Cell[96906, 2232, 3376, 97, 86, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100319, 2334, 319, 8, 37, "Input"],
Cell[100641, 2344, 1214, 34, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101892, 2383, 219, 6, 37, "Input"],
Cell[102114, 2391, 1140, 34, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103291, 2430, 217, 6, 37, "Input"],
Cell[103511, 2438, 96, 1, 37, "Output"]
}, Open  ]]
}
]
*)

